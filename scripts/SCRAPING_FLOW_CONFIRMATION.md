# スクレイピングフロー確認結果

## ✅ 大前提
**取得するのはドキュメント上でnullになっている情報のみ**
- ✅ 実装済み: `getNullFields()`関数でnullフィールドを取得
- ✅ 実装済み: 各スクレイピング関数で`nullFields.includes()`でチェック
- ✅ 実装済み: `collectCompanyData()`でnullフィールドがない場合はスキップ

## 各サイトの検索フロー実装状況

### 1. 企業INDEXナビ ✅
- **URL**: `https://cnavi-app.g-search.or.jp/`
- **ログイン**: ID: `h.shiroyama@legatuscorp.com`, PW: `Furapote0403/`
- **実装状況**: ✅ 実装済み
- **検索フロー**:
  1. ✅ 法人番号がある場合は直接アクセス: `https://cnavi-app.g-search.or.jp/corporatedetail?corporateNumber={法人番号}`
  2. ✅ 法人番号がない場合は検索フロー:
     - 「企業名で探す」のテキストボックスに企業名を入力
     - 「検索する」ボタンを押下
     - 企業リストから企業名+住所がマッチする「企業名」列をクリック
  3. ✅ 企業詳細画面から情報を取得（「サイトを見る」リンクも取得）
- **エラーハンドリング**: ✅ 「指定された検索条件に一致する結果がありませんでした。」をチェック

### 2. バフェットコード ✅
- **URL**: `https://www.buffett-code.com/global_screening`
- **ログイン**: ID: `h.shiroyama@legatuscorp.com`, PW: `furapote0403`
- **実装状況**: ✅ 実装済み（`scrapeOperatingIncomeFromBuffett`）
- **検索フロー**:
  1. ✅ 検索ボックスに企業名を入力
  2. ✅ Enterキーを押下
  3. ✅ 企業リストから企業名のリンクをクリック
  4. ✅ 「企業概要」「業績」「大株主」「役員」から情報を取得
- **エラーハンドリング**: ✅ 「検索結果はありませんでした。」をチェック

### 3. マイナビ転職 ✅
- **URL**: `https://tenshoku.mynavi.jp/company/`
- **実装状況**: ✅ 実装済み（`scrapeFromMynavi`）
- **検索フロー**:
  1. ✅ 検索テキストボックスに企業名を入力
  2. ✅ 「企業を検索する」ボタンを押下
  3. ✅ 企業リストから企業名のリンクをクリック
  4. ✅ 企業詳細画面から情報を取得
- **エラーハンドリング**: ✅ 「該当する企業はありませんでした。」をチェック

### 4. マイナビ2026 ✅
- **URL**: `https://job.mynavi.jp/26/pc/search/corp.html?tab=corp`
- **実装状況**: ✅ 実装済み（`scrapeFromMynavi2026`）
- **検索フロー**:
  1. ✅ 検索テキストボックスに企業名を入力
  2. ✅ 「検索」ボタンを押下
  3. ✅ 企業リストから企業名のリンクをクリック
  4. ✅ 企業詳細画面から情報を取得
- **エラーハンドリング**: ✅ 検索ボタンが無効の場合は取得不可として処理

### 5. 全国法人リスト ❌
- **URL**: `https://houjin.jp/`
- **実装状況**: ❌ 未実装
- **必要な検索フロー**:
  1. 検索テキストボックスに企業名を入力
  2. 検索ボタンを押下
  3. 企業名のリンクをクリック（広告が表示される場合は右上の×を押下）
  4. 「基本情報」と「決算情報」のタブから情報を取得
- **エラーハンドリング**: 「検索後0件を表示/全0件」を検知すると取得不可

### 6. 官報決算データベース ✅
- **URL**: `https://catr.jp/`
- **実装状況**: ✅ 実装済み（`scrapeOperatingIncomeFromCatr`）
- **検索フロー**:
  1. ✅ 画面上部の検索テキストボックスに企業名を入力
  2. ✅ 検索ボタンを押下
  3. ✅ 「上場企業の関連会社から探す」または「{企業名}の検索結果(最大100件)」の企業名リンクをクリック（広告が表示される場合は右上の×を押下）
  4. ✅ 「会社基本情報」セクションや「決算一覧」セクションから情報を取得
- **エラーハンドリング**: ✅ 結果が表示されない場合は取得不可

### 7. Alarmbox ❌
- **URL**: `https://alarmbox.jp/companyinfo/`
- **実装状況**: ❌ 未実装
- **必要な検索フロー**:
  1. 画面上部の検索テキストボックスに企業名を入力
  2. 検索ボタンを押下
  3. 企業名のリンクをクリックして企業詳細画面に遷移
  4. 「{企業名}の企業情報」セクションや「{企業名}に関する詳細な企業情報」セクションや「{企業名}の決算・業績・財務情報」セクションから情報を取得

### 8. uSonar YELLOWPAGE ✅
- **URL**: `https://yellowpage.usonar.co.jp/`
- **実装状況**: ✅ 実装済み（`scrapeFromUsonarYellowpage`）
- **検索フロー**:
  1. ✅ 検索テキストボックスに企業名を入力
  2. ✅ 虫眼鏡マーク（検索ボタン）を押下
  3. ✅ 検索結果で企業リストから企業名のリンクをクリック
  4. ✅ 企業詳細画面から情報を取得（電話番号、代表者名など）

## まとめ

### 実装済み（6サイト）
1. ✅ 企業INDEXナビ
2. ✅ バフェットコード
3. ✅ マイナビ転職
4. ✅ マイナビ2026
5. ✅ 官報決算データベース
6. ✅ uSonar YELLOWPAGE

### 未実装（2サイト）
1. ❌ 全国法人リスト
2. ❌ Alarmbox

## 次のステップ

全国法人リストとAlarmboxの実装を追加する必要があります。ただし、これらのサイトは現在のスクレイピングフローで特定のフィールドを取得するために使用されていないため、必要に応じて実装を追加します。

